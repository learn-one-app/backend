{"version":3,"sources":["utils/request.ts","components/Add.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["request","options","axios","headers","Cookies","get","Add","reload","noop","field","setValue","getValue","init","validate","useEffect","record","name","age","title","isShowing","width","onClose","onCancel","onOk","errors","values","a","url","method","data","id","_id","isProcessing","Item","label","required","rules","message","style","SWrapper","styled","div","App","Field","useField","fetchData","res","type","onClick","dataSource","marginTop","Column","dataIndex","cell","value","index","handleDelete","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.077b12bd.chunk.js","sourcesContent":["import axios, { AxiosRequestConfig } from 'axios';\nimport Cookies from 'js-cookie';\n\nfunction request(options: AxiosRequestConfig) {\n  return axios({\n    ...options,\n    headers: {\n      'x-csrf-token': Cookies.get('csrfToken'),\n    },\n  });\n}\n\nexport default request;\n\n// if (axiosOptions.method === 'get') {\n//     opts = {\n//       params,\n//       paramsSerializer: params => qs.stringify(params, { indices: false }),\n//     };\n//   } else {\n//     const { url } = axiosOptions;\n//     const formatUrl = isEmpty(params) ? url : `${url}${includes(url, '?') ? '&' : '?'}${qs.stringify(params)}`;\n//     const formatData = includes(currentContentType, 'application/json') ? JSON.stringify(data) : qs.stringify(data);\n//     opts = { data: formatData, url: formatUrl };\n//   }\n","import React, { useEffect } from 'react';\nimport { Field, Form, Input, NumberPicker } from '@alicloud/console-components';\nimport SlidePanel from '@alicloud/console-components-slide-panel';\nimport request from '../utils/request';\nimport { noop } from 'lodash';\n\ninterface AddOptions {\n  reload?: Function;\n  field: Field;\n}\n\ninterface RecordItem {\n  name: string;\n  age: number;\n  _id: number;\n}\n\nfunction Add(options: AddOptions) {\n  const { reload = noop, field } = options;\n  const { setValue, getValue, init, validate } = field;\n  useEffect(() => {\n    if (getValue('isShowing') && getValue('type') === 'edit') {\n      const record: RecordItem = getValue('record');\n      setValue('name', record.name);\n      setValue('age', record.age);\n    }\n  }, [getValue('type'), getValue('isShowing')]);\n\n  const handleConfirm = () => {\n    validate(async (errors, values) => {\n      setValue('isProcessing', true);\n      const record: RecordItem = getValue('record');\n      try {\n        await request({\n          url: '/api/user',\n          method: getValue('type') === 'edit' ? 'put' : 'post',\n          data: {\n            name: getValue('name'),\n            age: getValue('age'),\n            id: record?._id,\n          },\n        });\n        setValue('isShowing', false);\n        reload();\n        setValue('isProcessing', false);\n      } catch (error) {\n        setValue('isProcessing', false);\n      }\n    });\n  };\n\n  return (\n    <SlidePanel\n      title={getValue('title')}\n      isShowing={getValue('isShowing')}\n      width=\"medium\"\n      onClose={() => setValue('isShowing', false)}\n      onCancel={() => setValue('isShowing', false)}\n      onOk={handleConfirm}\n      isProcessing={getValue('isProcessing')}\n    >\n      <Form field={field}>\n        <Form.Item label=\"姓名\" required>\n          <Input\n            {...init('name', {\n              rules: {\n                required: true,\n                message: '请输入姓名',\n              },\n            })}\n          />\n        </Form.Item>\n        <Form.Item label=\"年龄\" required>\n          <NumberPicker\n            style={{ width: '100%' }}\n            {...init('age', {\n              rules: {\n                required: true,\n                message: '请输入年龄',\n              },\n            })}\n          />\n        </Form.Item>\n      </Form>\n    </SlidePanel>\n  );\n}\n\nexport default Add;\n","import React, { useEffect } from 'react';\nimport { Table, Field, Button } from '@alicloud/console-components';\nimport styled from 'styled-components';\nimport { get } from 'lodash';\nimport Add from './components/Add';\nimport request from './utils/request';\nimport Actions, { LinkButton } from '@alicloud/console-components-actions';\n\nfunction App() {\n  const field = Field.useField();\n  const { setValue, getValue } = field;\n\n  const fetchData = async () => {\n    const res = await request({ url: '/api/user' });\n    setValue('data', get(res, 'data.data'));\n  };\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const renderOpt = (value: any, index: any, record: any) => {\n    const handleEdit = () => {\n      setValue('isShowing', true);\n      setValue('title', '编辑用户');\n      setValue('type', 'edit');\n      setValue('record', record);\n    };\n\n    const handleDelete = async () => {\n      await request({\n        url: '/api/user',\n        method: 'DELETE',\n        data: {\n          id: record._id,\n        },\n      });\n      fetchData();\n    };\n    return (\n      <Actions>\n        <LinkButton onClick={handleEdit}>编辑</LinkButton>\n        <LinkButton onClick={handleDelete}>删除</LinkButton>\n      </Actions>\n    );\n  };\n\n  const handleAdd = () => {\n    setValue('isShowing', true);\n    setValue('title', '新建用户');\n    setValue('type', 'add');\n  };\n\n  return (\n    <SWrapper>\n      <h1>一个简单的CRUD演示(react+axios+egg+mongodb)</h1>\n      <Button type=\"primary\" onClick={handleAdd}>\n        新建用户\n      </Button>\n      <Table dataSource={getValue('data')} style={{ marginTop: 16 }}>\n        <Table.Column title=\"姓名\" dataIndex=\"name\" width=\"40%\" />\n        <Table.Column title=\"年龄\" dataIndex=\"age\" width=\"40%\" />\n        <Table.Column title=\"操作\" cell={renderOpt} width=\"20%\" />\n      </Table>\n      <Add reload={fetchData} field={field} />\n    </SWrapper>\n  );\n}\n\nconst SWrapper = styled.div`\n  padding: 0 24px;\n`;\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport '@alicloud/console-components/dist/wind.css'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root'),\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals()\n"],"sourceRoot":""}